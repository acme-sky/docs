"use strict";(self.webpackChunkacme_sky_docs=self.webpackChunkacme_sky_docs||[]).push([[901],{69:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>d});var a=i(4848),s=i(8453);const t={sidebar_position:3,slug:"/services/bank"},o="Bank",r={id:"services/bank",title:"Bank",description:"Servizio usato come gateway di pagamenti. Rircorda molto l'uso del noto servizio",source:"@site/docs/services/bank.md",sourceDirName:"services",slug:"/services/bank",permalink:"/services/bank",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,slug:"/services/bank"},sidebar:"defaultSidebar",previous:{title:"Servizi",permalink:"/services/"},next:{title:"Rent",permalink:"/services/rent"}},c={},d=[{value:"Set up",id:"set-up",level:2},{value:"API",id:"api",level:2},{value:"POST /payments/",id:"post-payments",level:3},{value:"GET /payments/&lt;id&gt;/",id:"get-paymentsid",level:3},{value:"POST /payments/&lt;id&gt;/pay/",id:"post-paymentsidpay",level:3},{value:"Frontend",id:"frontend",level:2},{value:"Codice sorgente",id:"codice-sorgente",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"bank",children:"Bank"}),"\n",(0,a.jsxs)(n.p,{children:["Servizio usato come gateway di pagamenti. Rircorda molto l'uso del noto servizio\nonline ",(0,a.jsx)(n.a,{href:"https://paypal.com",children:"PayPal"})," in cui un servizio terzo pu\xf2 creare una\nrichiesta di pagamento che poi un utente pu\xf2 completare usando un account\nassociato."]}),"\n",(0,a.jsx)(n.p,{children:"A differenza del servizio online sopracitato, Acmebank, non richiede che l'utente pagante sia registrato."}),"\n",(0,a.jsx)(n.h2,{id:"set-up",children:"Set up"}),"\n",(0,a.jsx)(n.p,{children:"Il servizio \xe8 diviso in due:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"API"}),". REST API scritta in OCaml la quale espone degli endpoint disponibili\nsolo per i possessori di un ",(0,a.jsx)(n.code,{children:"API-TOKEN"})," ed altri pubblici, come ad esempio,\nquello della conferma pagamento."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Frontend"}),". Scritto in Vue.js, \xe8 composto da una single-page mostrata\nall'utente che deve completare il pagamento inserendo i dati della propria\ncarta di credito. Il link alla pagina \xe8 generato da Acmebank in fase di\ncreazione di pagamento da parte di Acmesky."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Si pu\xf2 usare un file nella repository per creare una build del progetto, ma qui\ndi seguito viene riportato uno snippet."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'export POSTGRES_USER="$pg_user"\nexport POSTGRES_PASSWORD="$pg_pass"\nexport POSTGRES_DB="$pg_db"\nexport DATABASE_URL="postgres://$pg_user:$pg_pass@bankservice-postgres:5432/$pg_db"\nexport API_TOKEN="$api_token"\n\ndocker build -t acmesky-bankservice-api api\ndocker build -t acmesky-bankservice-ui --build-arg VITE_BACKEND_URL="$bank_api" ui\n\ndocker compose up\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Si vede come il servizio di frontend debba essere collegato all'API mediante una\nvariabile d'ambiente usata come argomento di build. Inoltre, l'host del database\n\xe8 lasciato, di default, col nome dell'immagine messa ",(0,a.jsx)(n.em,{children:"up"})," da Docker compose."]}),"\n",(0,a.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Swagger screenshot",src:i(8616).A+"",width:"1920",height:"925"})}),"\n",(0,a.jsx)(n.h3,{id:"post-payments",children:"POST /payments/"}),"\n",(0,a.jsxs)(n.p,{children:["Questa chiamata usa l'",(0,a.jsx)(n.code,{children:"API Token"})," header ",(0,a.jsx)(n.code,{children:"X-API-TOKEN"})," e crea un nuovo pagamento."]}),"\n",(0,a.jsx)(n.p,{children:"Request:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "owner": "Mario Rossi",\n  "amount": 42.1,\n  "description": "Flight to CPH",\n  "callback": "http://acmesky.cs.unibo.it/api/pay/42/"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Response:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "id": "23db02df-dda6-4897-9391-5767b262a88c",\n    "owner": "John Doe",\n    "amount": 30.4,\n    "description": "Flight to CPH",\n    "callback": "http://acmesky.cs.unibo.it/api/pay/42/",\n    "paid": false,\n    "created_at": "2024-04-15 16:02:02.928454"\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"get-paymentsid",children:"GET /payments/<id>/"}),"\n",(0,a.jsx)(n.p,{children:"Lo stesso response di sopra:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n    "id": "23db02df-dda6-4897-9391-5767b262a88c",\n    "owner": "John Doe",\n    "amount": 30.4,\n    "description": "Flight to CPH",\n    "callback": "http://acmesky.cs.unibo.it/api/pay/42/",\n    "paid": false,\n    "created_at": "2024-04-15 16:02:02.928454"\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"post-paymentsidpay",children:"POST /payments/<id>/pay/"}),"\n",(0,a.jsxs)(n.p,{children:["Chiamata usata per pagare. Esso cambia lo stato di ",(0,a.jsx)(n.code,{children:"paid"})," a ",(0,a.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"frontend",children:"Frontend"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://raw.githubusercontent.com/acme-sky/bank-service/main/assets/screenshot.png",alt:"Screenshot frontend"})}),"\n",(0,a.jsx)(n.p,{children:"Il frontend \xe8 la pagina principale in cui vengono richieste le informazioni\ndella carta di credito per procedere al pagamento."}),"\n",(0,a.jsx)(n.p,{children:"In realt\xe0 i dati della carta vengono ignorati perch\xe9 non usati realmente nel\npagamento."}),"\n",(0,a.jsx)(n.h2,{id:"codice-sorgente",children:"Codice sorgente"}),"\n",(0,a.jsxs)(n.p,{children:["Il server \xe8 presente alla seguente ",(0,a.jsx)(n.a,{href:"https://github.com/acme-sky/bank-service",children:"repository Github"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8616:(e,n,i)=>{i.d(n,{A:()=>a});const a=i.p+"assets/images/swagger-acmebank-e10dcf5ad7fa5ecf7a191d7587b8912f.png"},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var a=i(6540);const s={},t=a.createContext(s);function o(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);