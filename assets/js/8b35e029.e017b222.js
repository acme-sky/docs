"use strict";(self.webpackChunkacme_sky_docs=self.webpackChunkacme_sky_docs||[]).push([[901],{69:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>l});var i=a(4848),s=a(8453);const t={sidebar_position:3,slug:"/services/bank"},o="Bank",r={id:"services/bank",title:"Bank",description:"Il servizio Bank funge da gateway di pagamenti per ACMESky, simile al noto servizio online PayPal. Consente a un servizio terzo di creare una richiesta di pagamento che pu\xf2 essere completata da un utente utilizzando un account associato, senza la necessit\xe0 che l'utente pagante sia registrato.",source:"@site/docs/services/bank.md",sourceDirName:"services",slug:"/services/bank",permalink:"/docs/services/bank",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,slug:"/services/bank"},sidebar:"defaultSidebar",previous:{title:"Airline",permalink:"/docs/services/airline"},next:{title:"Rent",permalink:"/docs/services/rent"}},c={},l=[{value:"Set up",id:"set-up",level:2},{value:"API",id:"api",level:2},{value:"/payments/",id:"payments",level:3},{value:"/payments/&lt;id&gt;/",id:"paymentsid",level:3},{value:"/payments/&lt;id&gt;/pay/",id:"paymentsidpay",level:3},{value:"Frontend",id:"frontend",level:2},{value:"Codice sorgente",id:"codice-sorgente",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"bank",children:"Bank"}),"\n",(0,i.jsxs)(n.p,{children:["Il servizio Bank funge da gateway di pagamenti per ACMESky, simile al noto servizio online ",(0,i.jsx)(n.a,{href:"https://paypal.com",children:"PayPal"}),". Consente a un servizio terzo di creare una richiesta di pagamento che pu\xf2 essere completata da un utente utilizzando un account associato, senza la necessit\xe0 che l'utente pagante sia registrato."]}),"\n",(0,i.jsx)(n.p,{children:"\xc8 composto da due parti:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"API"}),": Una REST API scritta in OCaml che espone endpoint accessibili solo ai possessori di un ",(0,i.jsx)(n.code,{children:"API-TOKEN"}),", nonch\xe9 endpoint pubblici come quello per la conferma del pagamento."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Frontend"}),": Realizzato in Vue.js, il frontend consiste in una single-page mostrata all'utente per completare il pagamento inserendo i dati della propria carta di credito. Il link alla pagina \xe8 generato da Bank durante la creazione del pagamento da parte di ACMESky."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"set-up",children:"Set up"}),"\n",(0,i.jsx)(n.p,{children:"Qui di seguito viene riportato uno snippet per la build del progetto:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Clonare il repository\ngit clone git@github.com:acme-sky/bank-service.git\ncd bank-service\n\nexport POSTGRES_USER="$pg_user"\nexport POSTGRES_PASSWORD="$pg_pass"\nexport POSTGRES_DB="$pg_db"\nexport DATABASE_URL="postgres://$pg_user:$pg_pass@bankservice-postgres:5432/$pg_db"\nexport API_TOKEN="$api_token"\n\ndocker build -t acmesky-bankservice-api api\ndocker build -t acmesky-bankservice-ui --build-arg VITE_BACKEND_URL="$bank_api" ui\n\ndocker compose up\n'})}),"\n",(0,i.jsx)(n.p,{children:"Durante la build del frontend, puoi passare l'URL dell'API come argomento, utilizzando una variabile d'ambiente. In questo modo, il frontend sar\xe0 in grado di comunicare correttamente con l'API."}),"\n",(0,i.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Swagger screenshot",src:a(8616).A+"",width:"1920",height:"925"})}),"\n",(0,i.jsx)(n.h3,{id:"payments",children:"/payments/"}),"\n",(0,i.jsxs)(n.p,{children:["Questa chiamata usa l'",(0,i.jsx)(n.code,{children:"API Token"})," header ",(0,i.jsx)(n.code,{children:"X-API-TOKEN"})," e crea un nuovo pagamento."]}),"\n",(0,i.jsx)(n.p,{children:"Request:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'curl -X POST http://localhost:8080/payments/ -H \'x-api-token: token\' -H \'content-type: application/json\' -d \'\\\n{\n  "owner": "Mario Rossi",\n  "amount": 42.1,\n  "description": "Flight to CPH",\n  "callback": "http://acmesky.cs.unibo.it/api/pay/42/"\n}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"Response:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "id": "23db02df-dda6-4897-9391-5767b262a88c",\n    "owner": "John Doe",\n    "amount": 30.4,\n    "description": "Flight to CPH",\n    "callback": "http://acmesky.cs.unibo.it/api/pay/42/",\n    "paid": false,\n    "created_at": "2024-04-15 16:02:02.928454"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"paymentsid",children:"/payments/<id>/"}),"\n",(0,i.jsx)(n.p,{children:"Lo stesso response di sopra:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'curl http://localhost:8080/payments/bc7676ac-1a23-4ca9-98dc-462c7036de36/\n\nHTTP/1.1 200 OK\nAccess-Control-Allow-Headers: Content-Type\nAccess-Control-Allow-Methods: OPTIONS, GET, HEAD, POST\nAccess-Control-Allow-Origin: *\nAccess-Control-Max-Age: 86400\nAllow: OPTIONS, GET, HEAD, POST\nContent-Length: 215\nContent-Type: application/json\n{\n    "id": "23db02df-dda6-4897-9391-5767b262a88c",\n    "owner": "John Doe",\n    "amount": 30.4,\n    "description": "Flight to CPH",\n    "callback": "http://acmesky.cs.unibo.it/api/pay/42/",\n    "paid": false,\n    "created_at": "2024-04-15 16:02:02.928454"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"paymentsidpay",children:"/payments/<id>/pay/"}),"\n",(0,i.jsxs)(n.p,{children:["Chiamata usata per pagare. Esso cambia lo stato di ",(0,i.jsx)(n.code,{children:"paid = false"})," a ",(0,i.jsx)(n.code,{children:"paid = true"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"frontend",children:"Frontend"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://raw.githubusercontent.com/acme-sky/bank-service/main/assets/screenshot.png",alt:"Screenshot frontend"})}),"\n",(0,i.jsx)(n.p,{children:"Il frontend richiede le informazioni della carta di credito, ma queste informazioni non vengono effettivamente utilizzate nel processo di pagamento. In questo caso, il frontend funge principalmente da interfaccia utente per avviare il processo di pagamento."}),"\n",(0,i.jsx)(n.h2,{id:"codice-sorgente",children:"Codice sorgente"}),"\n",(0,i.jsxs)(n.p,{children:["Il server \xe8 presente alla seguente ",(0,i.jsx)(n.a,{href:"https://github.com/acme-sky/bank-service",children:"repository Github"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8616:(e,n,a)=>{a.d(n,{A:()=>i});const i=a.p+"assets/images/swagger-acmebank-e10dcf5ad7fa5ecf7a191d7587b8912f.png"},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var i=a(6540);const s={},t=i.createContext(s);function o(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);