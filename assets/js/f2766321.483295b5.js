"use strict";(self.webpackChunkacme_sky_docs=self.webpackChunkacme_sky_docs||[]).push([[478],{7456:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var i=s(4848),r=s(8453);const o={sidebar_position:4,slug:"/services/rent"},t="Rent",a={id:"services/rent",title:"Rent",description:'Il servizio "Rent" \xe8 un componente fondamentale dell\'ecosistema ACMESky. Contrariamente alle aspettative, questo servizio non \xe8 un sistema di noleggio di veicoli, bens\xec fa riferimento a un servizio di taxi o car sharing simile a piattaforme famose come Uber o Bolt.',source:"@site/docs/services/rent.md",sourceDirName:"services",slug:"/services/rent",permalink:"/docs/services/rent",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,slug:"/services/rent"},sidebar:"defaultSidebar",previous:{title:"Bank",permalink:"/docs/services/bank"},next:{title:"Geodistance",permalink:"/docs/services/geodistance"}},c={},l=[{value:"Set up",id:"set-up",level:2},{value:"API",id:"api",level:2},{value:"Codice sorgente",id:"codice-sorgente",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"rent",children:"Rent"}),"\n",(0,i.jsx)(n.p,{children:'Il servizio "Rent" \xe8 un componente fondamentale dell\'ecosistema ACMESky. Contrariamente alle aspettative, questo servizio non \xe8 un sistema di noleggio di veicoli, bens\xec fa riferimento a un servizio di taxi o car sharing simile a piattaforme famose come Uber o Bolt.'}),"\n",(0,i.jsx)(n.p,{children:"ACMESky utilizza il servizio \"Rent\" per garantire un'esperienza completa ai suoi utenti durante il processo di prenotazione dei viaggi. In particolare, il servizio viene attivato quando il costo di un viaggio supera la soglia dei 1000\u20ac. In queste circostanze, ACMESky prenota automaticamente un trasferimento per l'utente dalla propria residenza all'aeroporto di partenza del viaggio."}),"\n",(0,i.jsx)(n.h2,{id:"set-up",children:"Set up"}),"\n",(0,i.jsxs)(n.p,{children:["Rent \xe8 un'API SOAP scritta in ",(0,i.jsx)(n.a,{href:"https://www.jolie-lang.org",children:"Jolie"}),". Per avviare\nil server bisogna prima generare un servizio per un dato ",(0,i.jsx)(n.code,{children:"namespace"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"jolie2wsdl --namespace <namespace> --portName RentPort --portAddr <portaddr> --outputFile <file.wsdl> server.ol\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ad esempio, per un possibile ",(0,i.jsx)(n.code,{children:"uber.acmesky.cs.unibo.it"})," simile al noto servizio\n",(0,i.jsx)(n.a,{href:"https://www.uber.com/it/it/",children:"Uber"})," che gira nella porta locale ",(0,i.jsx)(n.code,{children:"8080"})," potremmo avere:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"jolie2wsdl --namespace uber.acmesky.cs.unibo.it --portName RentPort --portAddr http://localhost:8080 --outputFile uber-acmesky.wsdl server.ol\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Successivamente baster\xe0 creare un file di configurazione ",(0,i.jsx)(n.code,{children:"config.json"}),"\nspecificando:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "location": "socket://localhost:8080",\n    "proto": {\n        "$": "soap",\n        "wsdl": "/etc/data/uber-acmesky.wsdl"\n    },\n    "database": {\n        "username": "username",\n        "password": "password",\n        "host": "localhost",\n        "name": "rent"\n    }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Dal file di configurazione di Docker compose si vede come la cartella corrente\nvenga mappata automaticamente nel volume in ",(0,i.jsx)(n.code,{children:"/etc/data"}),". Dunque, il WSDL in\nproduzioneu sar\xe0 ",(0,i.jsx)(n.code,{children:"/etc/data/uber-acmesky.wsdl"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Bisogna inoltre mettere ",(0,i.jsx)(n.em,{children:"up"})," un servizio di webserver per esporre il WSDL online\ncos\xec da poter essere richiamato dal Worker di ACMESky."]}),"\n",(0,i.jsx)(n.p,{children:"La build pu\xf2 proseguire con:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Build del servizio di Rent."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ docker build -t acmesky-rentservice .\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"File WSDL in cartella statica."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ mkdir www\n$ copy uber-acmesky.wsdl www\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Creazione di config per il webserver Leonardo."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'# config-leonardo.json\n{\n    "location": "<location>",\n    "documentDir": "/etc/data/www/"\n}\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Build del servizio Leonardo."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ docker build -t acmesky-rentleonardo -f Dockerfile-leonardo .\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Infine grazie a Docker compose si possono mettere entrambi i servizi ",(0,i.jsx)(n.em,{children:"up"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"$ docker compose up\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Rent input port",src:s(6446).A+"",width:"643",height:"530"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["La richiesta \xe8 del tipo ",(0,i.jsx)(n.code,{children:"RentRequest"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"type RentRequest: void {\n     .PickupAddress[1,1]: string\n     .Address[1,1]: string\n     .CustomerName[1,1]: string\n     .PickupDate[1,1]: string\n}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["La risposta \xe8 del tipo ",(0,i.jsx)(n.code,{children:"RentResponse"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"type RentResponse: void {\n     .Status[1,1]: string\n     .RentId[0,1]: string\n     .Error[0,1]: string\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Un test pu\xf2 essere fatto dal seguente payload:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:rent="uber.acmesky.cs.unibo.it.xsd">\n   <soapenv:Header/>\n   <soapenv:Body>\n      <rent:BookRent>\n         <CustomerName>Mario</CustomerName>\n         <PickupAddress>Via Zamboni 33, Bologna</PickupAddress>\n         <Address>Mura Anteo Zamboni 7, Bologna</Address>\n         <PickupDate>2024-03-02T13:10:00Z</PickupDate>\n      </rent:BookRent>\n   </soapenv:Body>\n</soapenv:Envelope>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"codice-sorgente",children:"Codice sorgente"}),"\n",(0,i.jsxs)(n.p,{children:["Il server \xe8 presente alla seguente ",(0,i.jsx)(n.a,{href:"https://github.com/acme-sky/rentservice-api",children:"repository Github"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6446:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/rent-inputport-b740dae2053c724bc2a15e3e9b1bd546.png"},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const r={},o=i.createContext(r);function t(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);